### 
### Sunsteel API Manual Testing
### Use VS Code REST Client extension (free) or copy these into Thunder Client individual requests
###

@baseUrl = http://localhost:4000/api
@email = test-user@example.com
@password = SecurePassword123!

# Supply a valid Supabase JWT (from frontend login) for manual testing
@supabaseToken = YOUR_SUPABASE_JWT_HERE

### STEP 1: Verify Supabase Token
# @name verify-supabase
POST {{baseUrl}}/auth/supabase/verify
Content-Type: application/json

{
  "token": "{{supabaseToken}}"
}

# Note:
# - Replace {{supabaseToken}} with a real Supabase JWT (Bearer token).
# - Subsequent requests use Authorization: Bearer {{supabaseToken}}.

###
### STEP 2: Create Routine (Simple)
# Use the token from Step 1
POST {{baseUrl}}/routines
Content-Type: application/json
Authorization: Bearer {{supabaseToken}}

{
  "name": "Manual Test Routine",
  "description": "Testing via HTTP client",
  "isPeriodized": false,
  "days": [
    {
      "dayOfWeek": 1,
      "exercises": [
        {
          "exerciseId": "USE_AN_EXERCISE_ID_FROM_YOUR_DB",
          "restSeconds": 120,
          "progressionScheme": "NONE",
          "sets": [
            {
              "setNumber": 1,
              "repType": "FIXED",
              "reps": 10,
              "weight": 50
            }
          ]
        }
      ]
    }
  ]
}

###
### STEP 3: Create Complex Routine (PROGRAMMED_RTF + DDP)
POST {{baseUrl}}/routines
Content-Type: application/json
Authorization: Bearer {{supabaseToken}}

{
  "name": "Complex Test Routine",
  "description": "Testing PROGRAMMED_RTF and DYNAMIC_DOUBLE_PROGRESSION",
  "isPeriodized": false,
  "programStartDate": "2025-10-06",
  "programTimezone": "America/Cordoba",
  "programWithDeloads": true,
  "days": [
    {
      "dayOfWeek": 1,
      "exercises": [
        {
          "exerciseId": "EXERCISE_ID_1",
          "restSeconds": 180,
          "progressionScheme": "PROGRAMMED_RTF",
          "minWeightIncrement": 2.5,
          "programTMKg": 100,
          "programRoundingKg": 2.5,
          "programStyle": "STANDARD",
          "sets": [
            {
              "setNumber": 1,
              "repType": "RANGE",
              "minReps": 8,
              "maxReps": 10
            }
          ]
        },
        {
          "exerciseId": "EXERCISE_ID_2",
          "restSeconds": 120,
          "progressionScheme": "DYNAMIC_DOUBLE_PROGRESSION",
          "minWeightIncrement": 2.5,
          "sets": [
            {
              "setNumber": 1,
              "repType": "FIXED",
              "reps": 10,
              "weight": 50
            }
          ]
        }
      ]
    }
  ]
}

###
### STEP 4: Get All Routines
GET {{baseUrl}}/routines
Authorization: Bearer {{supabaseToken}}

###
### STEP 5: Get Specific Routine (replace with actual ID)
GET {{baseUrl}}/routines/ROUTINE_ID_HERE
Authorization: Bearer {{supabaseToken}}

###
### STEP 6: Delete Routine (replace with actual ID)
DELETE {{baseUrl}}/routines/ROUTINE_ID_HERE
Authorization: Bearer {{supabaseToken}}

###
### HELPER: Get Exercises (to find exercise IDs)
GET {{baseUrl}}/exercises
Authorization: Bearer {{supabaseToken}}

###
### HELPER: Get Exercises by Muscle Group
GET {{baseUrl}}/exercises?primaryMuscles=PECTORAL
Authorization: Bearer {{supabaseToken}}

###
### HELPER: Profile (requires Supabase Bearer token)
# @name profile
GET {{baseUrl}}/auth/supabase/profile
Authorization: Bearer {{supabaseToken}}

### HELPER: Health
GET {{baseUrl}}/auth/supabase/health

### HELPER: Logout (clears session cookie)
POST {{baseUrl}}/auth/supabase/logout
